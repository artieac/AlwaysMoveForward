@model AlwaysMoveForward.AnotherBlog.Web.Areas.Admin.Models.BlogListModel
@using AlwaysMoveForward.AnotherBlog.Common.DomainModel;
@using AlwaysMoveForward.AnotherBlog.Web.Code.Extensions;
@using AlwaysMoveForward.AnotherBlog.Web.Code.Utilities;
@{
    Layout = "~/Areas/Admin/Views/Shared/_BlogLayout.cshtml";
    ViewBag.Common = Model.Common;
 }

@section headerPlugins
{
    <script src="/Scripts/Admin/ManageBlogLists.js" type="text/javascript"></script>
}
   
@{
    Dictionary<String, String> readonlyAttributes = new Dictionary<string, string>();
    readonlyAttributes.Add("class", "readonly");
    readonlyAttributes.Add("disabled", "true");
    
} 
<div class="bodyContent" ng-controller="ManageListsController">        
    <div class="contentPageTitle">
        <label>Manage Lists</label>
    </div> 
    <form id="addBlogList" action="/Admin/List/AddList" method=post>
        <input type="hidden" id="blogSubFolder" name="blogSubFolder" value="@Model.Common.TargetBlog.SubFolder" />
        <table class="table table-striped">
            <thead>
                <tr>
                    <th width="1%">&nbsp;</th>
                    <th width="20%">Name</th>
                    <th width="5%">Show Ordered</th>
                    <th width="10%">&nbsp;</th>
                </tr>
            </thead>
            <tbody ng-init="getAllBlogLists('@Model.Common.TargetBlog.SubFolder');">
                <tr ng-repeat="blogList in blogLists">
                    <td><input type="radio" name="selectedList" value="{{blogList.Id}}" ng-change="getBlogListItems('{{ blogList.Id }}');" ng-model="blogListElements.selectedList"/></td>
                    <td><input type="text" name="blogListName" value="{{ blogList.Name }}" ng-disabled="blogListElements.selectedList!=blogList.Id"/></td>
                    <td><input type="checkbox" name="showOrdered" value="{{ blogList.ShowOrdered }}" ng-disabled="blogListElements.selectedList!=blogList.Id"/></td>
                    <td>
                        <a class="readonly" ng-click="deleteBlogList('{{ blogList.Id }}', '@Model.Common.TargetBlog.SubFolder');">
                            <img src="/Content/images/action_delete.png" class="deleteList" alt=""/>
                        </a>
                        <input type="button" value="Save" ng-click="saveBlogList();" ng-show="blogListElements.selectedList==blogList.Id"/>
                    </td>
                </tr>
                <tr ng-form="newListForm">
                    <td></td>
                    <td><input type="text" name="newListName" ng-model="newList.name" required/></td>
                    <td><input type="checkbox" name="newListShowOrdered" ng-model="newList.showOrdered" value="false" /></td>                            
                    <td><input type="button" value="Add List" ng-disabled="newListForm.$invalid" ng-click="addBlogList('@Model.Common.TargetBlog.SubFolder');"/></td> 
                </tr>
            </tbody>
        </table>
    </form>
    <br />
    <div id="listItemsContainer">
        <div id="listItemsSection" >
            <form id="addNewListItemForm" action="/Admin/List/AddListItem" method="post">
                <input type="hidden" name="blogSubFolder" value="@Model.Common.TargetBlog.SubFolder" />
                <input type="hidden" name="blogListId" value="{{ currentList.Id }}" />
                <table class="tableBase">
                    <thead>
                        <tr class="tableHeader">
                            <td width="1%">&nbsp;</td>
                            <td width="20%">Name</td>
                            <td width="20%">Link</td>
                            <td width="5%">Display Order</td>
                            <td width="5%">&nbsp;</td>
                        </tr>
                    </thead>
                    <tbody>
                        <tr ng-repeat="blogListItem in currentList.Items" ng-class-even="tableRow1" ng-class-odd="tablerow2">
                            <td><input type="radio" name="selectedListItem" value="{{blogListItem.Id}}" ng-model="blogListItemElements.selectedListItem"/></td>
                            <td><input type="text" name="listItemName" class="readonly" value="{{ blogListItem.Name }}" ng-disabled="blogListItemElements.selectedListItem!=blogListItem.Id"/></td>
                            <td><input type="text" name="listItemRelatedLink" class="readonly" value="{{blogListItem.RelatedLink}}" ng-disabled="blogListItemElements.selectedListItem!=blogListItem.Id"/></td>
                            <td><input type="text" name="listItemDisplayOrder" class="readonly" value="{{blogListItem.DisplayOrder}}" ng-disabled="blogListItemElements.selectedListItem!=blogListItem.Id"/></td>
                            <td>
                                <a class="readonly" ng-click="deleteBlogListItem('{{ blogListItem.Id }}', '@Model.Common.TargetBlog.SubFolder');">
                                    <img src="/Content/images/action_delete.png" class="deleteList" alt=""/>
                                </a>
                                <input type="button" value="Save" ng-click="saveBlogListItem();" ng-show="blogListItemElements.selectedListItem==blogListItem.Id"/>
                            </td>
                        </tr>
                        <tr>
                            <td></td>
                            <td>
                                <input type="hidden" id="newListItemListId" name="newListItemListId" value="{{blogListElements.selectedList}}" ng-model="newListItem.listId"/>
                                <input type="text" id="newListItemName" name="newListItemName" ng-model="newListItem.name" required/>
                            </td>
                            <td><input type="text" id="newListItemRelatedLink" name="newListItemRelatedLink" ng-model="newListItem.relatedLink" required/></td>
                            <td><input type="text" id="newListItemDisplayOrder" name="newListItemDisplayOrder" ng-model="newListItem.displayOrder"/></td>
                            <td><input type="button" id="saveListItemButton" value="Add Item" ng-click="addBlogListItem();"/></td>
                        </tr>
                    </tbody>
                </table>
            </form>
        </div>
    </div>      
</div>


