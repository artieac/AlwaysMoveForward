@model AlwaysMoveForward.AnotherBlog.Web.Areas.Admin.Models.ManageBlogModel
@{
    Layout = "~/Areas/Admin/Views/Shared/_BlogLayout.cshtml";
    ViewBag.Common = Model.Common;
    ViewBag.CurrentAction = "EditPost";
    ViewBag.AdditionalUrlElements = Model.EntryList[0].Post.EntryId.ToString();
}
@section headerPlugins
{
    <script src="/Scripts/Admin/ManageBlogPosts.js" type="text/javascript"></script>
    <script type="text/javascript">
        $(document).ready(function () {
            $("#saveButton").click(function () {
                $("#saveForm").submit();
            });
        });

        setTimeout("ManageBlogPosts.ExecuteBlogEntryAutoSave()", 300000);
    </script>
}
<div class="bodyContent">
    <div class="panel panel-primary editAreaContainer">
        <div class="panel-header">
            Edit Blog Post
        </div>
        <div class="panel-body">
            <br />
            <form id="saveForm" action="/Admin/ManageBlog/EditPost/@Model.Common.TargetBlog.SubFolder/@Model.EntryList[0].Post.EntryId.ToString()" method="post">
                <input type="hidden" id="performSave" name="performSave" value="true" />
                <div>
                    <span class="label">title:</span>
                    <input type="text" id="title" name="title" value="@Model.EntryList[0].Post.Title" maxlength="50" />
                </div>
                <div>
                    <span class="label">is published:</span>
                    <input id='isPublished' name='isPublished' type='checkbox' @if (Model.EntryList[0].Post.IsPublished) { <text> checked </text>      } />
                </div>
                <div>
                    <span class="label">entry</span>
                    <textarea id="entryText" name="entryText">@Model.EntryList[0].Post.EntryText</textarea>
                </div>
                @{
                    String tagsAsString = "";

                    if (Model.EntryList[0].Post != null)
                    {
                        if (Model.EntryList[0].Tags.Count > 0)
                        {
                            tagsAsString = Model.EntryList[0].Tags[0].Name;
                        }

                        for (int i = 1; i < Model.EntryList[0].Tags.Count; i++)
                        {
                            tagsAsString += "," + Model.EntryList[0].Tags[i].Name;
                        }
                    }
                }
                <div>
                    <span class="label">tags</span>
                    <input class="blogEntryTextBox" type="text" id="tagInput" name="tagInput" value="@tagsAsString" />
                </div>
                <button type="button" class="btn btn-primary" id="saveButton" name="saveButton">Save</button>
            </form>
            <div style="display:none">
                <form id="blogEntryAjaxForm" action="/Admin/ManageBlog/AjaxPostSave" method="post">
                    <input type="hidden" id="ajaxIsPublished" name="ajaxIsPublished" value="@if(Model.EntryList[0].Post.IsPublished==true){<text>on</text>}else{<text>off</text>}" />
                    <input type="hidden" id="ajaxEntryId" name="ajaxEntryId" value="@Model.EntryList[0].Post.EntryId.ToString()" />
                    <input type="hidden" id="ajaxTitle" name="ajaxTitle" value="@Model.EntryList[0].Post.Title" />
                    <input type="hidden" id="ajaxEntryText" name="ajaxEntryText" value="@Model.EntryList[0].Post.EntryText" />
                    <input type="hidden" id="ajaxTagInput" name="ajaxTagInput" value="@tagsAsString" />
                </form>
            </div>
            <div id="fileUploadSection">
                @Html.Partial("_FileUploadControl", @Model.Common)
            </div>
        </div>
    </div>
</div>
