@model AlwaysMoveForward.AnotherBlog.Web.Areas.Admin.Models.UserModel
@using AlwaysMoveForward.Common.DomainModel;
@using AlwaysMoveForward.AnotherBlog.Common.DomainModel
@{
    ViewBag.Title = "Edit User";
    Layout = "~/Areas/Admin/Views/Shared/_AdminToolLayout.cshtml";
}
@section headerPlugins
{
    <script src="/Scripts/Admin/ManageUsers.js" type="text/javascript"></script>
    <script src="//tinymce.cachefly.net/4.1/tinymce.min.js"></script>
    <script>tinymce.init({ selector: 'textarea' });</script>
    <script type="text/javascript">
        $(document).ready(function () {
            $("#saveButton").click(function () {
                $("#saveForm").submit();
            });
        });
    </script>
 }
<div class="bodyContent">        
    <div class="panel panel-default editAreaContainer">
        <div class="panel-header">Edit User</div>
        <br />
        <div class="panel-body">
            @if (ViewData.ModelState.IsValid == false)
            {
                <div class="alert alert-danger">
                    @Html.ValidationMessage("userName")
                    <br />
                    @Html.ValidationMessage("email")
                    <br />
                    @Html.ValidationMessage("displayName")
                    <br />
                </div>
            }
            <div class="col-sm-7">
                <form id="saveForm" action="/Admin/UserManagement/Edit/@Model.CurrentUser.UserId" method="post">
                    <input type="hidden" name="performSave" value="true" />
                    <div>
                        <span class="wideLabel">user name:</span>
                        <input type="text" name="userName" id="userName" value="@Model.CurrentUser.UserName" />
                    </div>
                    <div>
                        <span class="wideLabel">password:</span>
                        <input type="password" name="password" id="password" />
                    </div>
                    <div>
                        <span class="wideLabel">email:</span>
                        <input type="text" name="email" id="email" value="@Model.CurrentUser.Email" />
                    </div>
                    <div>
                        <span class="wideLabel">display name:</span>
                        <input type="text" name="displayName" id="displayName" value="@Model.CurrentUser.DisplayName" />
                    </div>
                    <div>
                        <span class="wideLabel">site Administrator:</span>
                        @Html.CheckBox("isSiteAdmin", @Model.CurrentUser.IsSiteAdministrator)
                    </div>
                    <div>
                        <span class="wideLabel">approved Commenter:</span>
                        @Html.CheckBox("approvedCommenter", @Model.CurrentUser.ApprovedCommenter)
                    </div>
                    <div>
                        <span class="wideLabel">active:</span>
                        @Html.CheckBox("isActive", @Model.CurrentUser.IsActive)
                    </div>
                    <div>
                        <span class="label">about:</span>
                        <textarea id="userAbout" name="userAbout">@Model.CurrentUser.About</textarea>
                    </div>
                    <br />
                    <button type="button" class="btn btn-primary" id="saveButton">Save</button>
                </form>
            </div>
            <div class="col-sml-6">
                <div id="userBlogsContainer" name="userBlogsContainer">
                    <form id="viewUserBlogs" action="/Admin/UserManagement/ManageBlogs" method="post">
                        <input type="hidden" name="userId" value="@Model.CurrentUser.UserId" />
                    </form>
                    <script type="text/javascript">
                        ManageUsers.EditUserInitializeUserBlogs();
                    </script>
                </div>
                <form id="userAddBlogForm" action="/Admin/UserManagement/AddBlog" method="post">
                    <label>Grant Access</label>
                    <div>
                        <span class="label">blog:</span>
                        <select id="targetBlog" name="targetBlog">
                            @foreach (int blogKey in @Model.Blogs.Keys)
                            {
                                <option id="@Model.Blogs[blogKey].Name" name="@Model.Blogs[blogKey].Name" value="@Model.Blogs[blogKey].BlogId.ToString()">@Model.Blogs[blogKey].Name</option>
                            }
                        </select>
                    </div>
                    <div>
                        <span class="label">role:</span>
                        <select id="blogRole" name="blogRole">
                            @foreach (Role roleItem in ViewData.Model.Roles)
                            {
                                <option id="@roleItem.Name" name="@roleItem.Name" value="@roleItem.RoleId.ToString()">@roleItem.Name</option>
                            }
                        </select>
                    </div>
                    <br />
                    <button type="button" class="btn btn-primary" id="submitAddNewBlog">Grant Blog Access</button>
                </form>
                <script type="text/javascript">
                    ManageUsers.EditUserSetupUserBlogAjax();
                </script>
            </div>
        </div>
    </div>
</div>